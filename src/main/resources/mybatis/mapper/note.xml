<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.newlecture.web.dao.NoteDao">
	<select id="getAllNote" parameterType="com.newlecture.web.entity.NoteEntity">
		select * from note_tb
	</select>

	<select id="getNoteById" parameterType="com.newlecture.web.entity.NoteEntity">
		select *
		from note_tb
		where send_id = #{send_id}
		and	send_del_yn	= 'N'
	</select>

	<select id="findOneNote" parameterType="com.newlecture.web.entity.NoteEntity">
		select * from note_tb
		where note_idx = #{note_idx}
	</select>
	<update id="updateReadDate" parameterType="com.newlecture.web.entity.NoteEntity">
		UPDATE note_tb SET
			<if test="read_yn == 'N'">
				read_date = now(), read_yn = 'Y',
			</if>
				read_last_date = now()
		where note_idx = #{note_idx};

	</update>
	<update id="deleteNote" parameterType="com.newlecture.web.entity.NoteEntity">
		UPDATE note_tb SET send_del_yn = 'Y' where note_idx = #{note_idx};
	</update>

	<insert id="insertNote" parameterType="com.newlecture.web.entity.NoteEntity">
		insert into note_tb (send_id, recv_id, note_title, note_content,send_date,read_date)
		values (#{send_id}, #{recv_id}, #{note_title}, #{note_content},SUBSTR(send_date,1,19),'' )
	</insert>


</mapper>